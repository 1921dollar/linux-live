#!/bin/bash

exec xlunch --input /etc/xlunch/logout.dsv --noprompt --center --columns 3 --rows 1 \
            --background /usr/share/wallpapers/slax_wallpaper.jpg --font DejaVuSans/11 \
            --voidclickterminate --iconpadding 30 --textpadding 10 \
            --paddingswap --leastmargin 10 --hidemissing --iconsize 128 \
            --highlight /usr/share/icons/hicolor/128x128/apps/xlunch_highlight.png \
            --outputonly | while read LINE; do

   SND=/usr/share/sounds/shutdown.wav

   if [ "$LINE" != "" -a -r $SND ]; then
      # blank desktop with smooth effect (if compton still running)
      xlunch --noprompt --input /dev/null --bc 111111ff &
      # play shutdown sound
      aplay $SND
   fi

   if [ "$LINE" = "logout" ]; then
      killall Xorg
   fi

   if [ "$LINE" = "restart" ]; then
      reboot
   fi

   if [ "$LINE" = "shutdown" ]; then
      poweroff
   fi

done
